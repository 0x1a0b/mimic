"""
Interfaces for Mimic.
"""

from __future__ import absolute_import, division, unicode_literals

from zope.interface import Attribute, Interface


class IAPIMock(Interface):
    """
    An :obj:`IAPIMock` provides an API via an entry for services
    internal to Mimic in a tenant's service catalog.
    """

    def catalog_entries(tenant_id):  # pragma:nocover
        """
        Generate some :obj:`mimic.catalog.Entry` objects given the tenant ID.

        :param unicode tenant_id: the semi-internal tenant ID generated by
            Mimic.
        """

    def resource_for_region(region, uri_prefix,
                            session_store):  # pragma:nocover
        """
        Get a resource for the given region.
        """


class IExternalAPIMock(Interface):
    """
    An :obj:`IExternalAPIMock` provides an API via an entry for services
    external to Mimic in a tenant's service catalog.
    """
    name_key = Attribute("Name of the External API. Primarily used for "
                         "the internal mappings. Must be unique.")
    type_key = Attribute("Type of the Templatized External API. Primarily "
                         "used for the internal mappings. Must be unique.")

    def catalog_entries(tenant_id):  # pragma:nocover
        """
        Generate some :obj:`mimic.catalog.Entry` objects given the tenant ID.

        :param unicode tenant_id: the semi-internal tenant ID generated by
            Mimic.
        """

    def uri_for_service(region, service_id):  # pragma:nocover
        """
        Get the URI for the service in a given region
        """

class IEndPointTemplate(Interface):
    """
    AN :obj:`IEndPointTemplate` provides an interface for the OS-KSCATALOG
    Admin end-point templates, defining the fields.
    """
    id_key = Attribute("Unique Service ID")
    region_key = Attribute("Region the End-Point services")
    type_key = Attribute("Service type, example: object-store")
    name_key = Attribute("Service Name, example: Cloud Files")
    publicURL = Attribute("Internet Facing URL")
    internalURL = Attribute("Intranet Facing URL")
    adminURL = Attribute("Service Adminsitration URL")
    tenantAlias = Attribute("Tenant Alias to be appended to the "
                            "end-point URI")
    versionId = Attribute("Version Details")
    versionInfo = Attribute("URL to get the version information")
    versionList = Attribute("URL to determine which version is hosted "
                            "by the end-point")


class IExternalTemplatedAPIMock(Interface):
    """
    An :obj:`IExternalTemplatedAPIMock` provides an API via an entry for
    services external to Mimic in a tenant's service catalog.
    """
    id_key = Attribute("Unique Service ID")
    name_key = Attribute("Name of the Templatized External API. Primarily "
                         "used for the internal mappings. Must be unique.")
    type_key = Attribute("Type of the Templatized External API. Primarily "
                         "used for the internal mappings. Must be unique.")

    def catalog_entries(tenant_id):  # pragma:nocover
        """
        Generate some :obj:`mimic.catalog.Entry` objects given the tenant ID.

        :param unicode tenant_id: the semi-internal tenant ID generated by
            Mimic.
        """

    def uri_for_service(region, service_id, tenant_id):  # pragma:nocover
        """
        Get the URI for the service in a given region

        :param unicode tenant_id: the semi-internal tenant ID generated by
            Mimic.
        """

    def add_templates(templates):  # pragma:nocover
        """
        Add a new template for the external API

        :param unicode templates: an iterable of :obj:`IEndPointTemplate`
             to add to the :obj:`IExternalTemplatedAPIMock` instance
        """

    def remove_templates(templates):  # pragma:nocover
        """
        Add a new template for the external API

        :param unicode templates: an iterable of :obj:`IEndPointTemplate`
             to add to the :obj:`IExternalTemplatedAPIMock` instance
        """


class ICredential(Interface):
    """
    An :obj:`ICredential` provides identity authentication credentials.
    """
    type_key = Attribute("The type key to look for in a JSON dictionary "
                         "representing the credential.")

    def get_session(session_store):  # pragma:nocover
        """
        Get a session corresponding to the user and tenant from the given
        session store.

        :param session_store: The store of all sessions for all tenants for
            all plugins across all regions.
        :type session_store: :class:`mimic.session.SessionStore`

        :return: A session corresponding to the user and plugin data for a
            single tenant for all plugins across all regions.
        :rtype: :class:`mimic.session.SessionStore`
        """


class IAPIDomainMock(Interface):
    """
    An :obj:`IAPIDomainMock` provides an API via a root resource with a fixed
    name ahead of time.

    Top level mocks will appear as
    ``http://your-mimic-host.example:your-mimic-port/domain/<your-api>``, where
    ``<your-api>`` is the result of :obj:`IAPIDomainMock.domain```()``.
    """

    def domain():               # pragma:nocover
        """
        This should be a domain name.  For example, if you were mocking an API
        typically present at ``https://api.foo.example.com/v2/``, this should
        return ``u"api.foo.example.com"``.

        :return: the domain name for this top-level mock.
        :rtype: :obj:`six.text_type`
        """

    def resource():             # pragma:nocover
        """
        The resource which would appear at the root of the domain.  For
        example, if you were mocking an API typically present at
        ``https://api.foo.example.com/v2/``, this should return a resource
        whose ``.getChild("v2", ...)`` returns the root of the API.

        :return: The resource for the root of the API implemented by this
                 :obj:`IAPIDomainMock`.
        :rtype: :obj:`twisted.web.iweb.IResource`
        """
