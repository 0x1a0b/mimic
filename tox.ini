[tox]
envlist = py26, py27, pypy, docs, pep8

[testenv]
deps =
    unittest2
    discover
commands =
    python -m unittest discover

[testenv:cover]
deps =
    coverage
    unittest2
commands =
    coverage erase
    coverage run --source=mimic,twisted -m --branch unittest discover
    coverage report -m

[testenv:docs]
deps =
    doc8
    sphinx
    sphinx_rtd_theme
basepython = python2.7
commands =
    sphinx-build -W -b html -d {envtmpdir}/doctrees docs docs/_build/html
    sphinx-build -W -b latex -d {envtmpdir}/doctrees docs docs/_build/latex
    sphinx-build -W -b doctest -d {envtmpdir}/doctrees docs docs/_build/html
    sphinx-build -W -b linkcheck docs docs/_build/html
    doc8 --allow-long-titles docs/

[testenv:docs-spellcheck]
deps =
    {[testenv:docs]deps}
    pyenchant
    sphinxcontrib-spelling
basepython = python2.7
commands =
    sphinx-build -W -b spelling docs docs/_build/html

[testenv:pep8]
deps =
    flake8
    #flake8-import-order
    pep257
commands =
    flake8 .
    pep257 --ignore=D400,D401,D200,D203,D204,D205 mimic twisted

[flake8]
exclude = docs,.tox,*.egg,*.pyc,.git,__pycache
max-line-length = 105
